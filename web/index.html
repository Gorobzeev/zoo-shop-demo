<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Zoo shop DEMO</title>
  <script src="js/jquery-2.1.4.min.js"></script>
</head>
<body>
<script type="application/javascript">
  $.getJSON("api/pets", function (data) {
    var trHTML = '';
    $.each(data, function (index, value) {
      trHTML  += '<tr id= "' + value.id + '">' +
                      '<td class="name">' + value.name + '</td>' +
                      '<td class="price">' + value.price + '</td>' +
                      '<td class="category">' + value.category + '</td>' +
                      '<td><button class="btn_edit" onclick="editPet('+value.id + ')">Edit</button></td>' +
                      '<td><button class="btn_delete" onclick="deletePet(' + value.id + ')">Delete</button></td>' +
                '</tr>';
    });

    $('#pets_table').append(trHTML);
  });
  function deletePet(id) {
    console.log("here delete id = " + id);
    $.ajax({
      url: 'api/pets/' + id,
      type: 'DELETE',
      success: function(result) {
        console.log('Pet ' + result.name + ' deleted.');
        $("#" + id).remove();
      }
    });
  }

  var update_id;
  function editPet(id){
    console.log("update init - " + id);
    $("#btn_create").hide();
    $("#btn_update").show();
    $("#input_name").val($("#" + id + " .name").text());
    $("#input_price").val($("#" + id + " .price").text());
    $("#input_category").val($("#" + id + " .category").text());
    update_id = id;
  }



  $(document).ready(function () {
    $("#btn_create").click(function () {
      var name = $('input[name="name"]').val();
      var price = $('input[name="price"]').val();
      var category = $('input[name="category"]').val();
      var pet = {
        name : name,
        price : price,
        category : category
      };
      var data = JSON.stringify(pet);
      console.log("send - " + data);
      $.ajax({
        type: "POST",
        url: "api/pets",
        data: data,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(value){
          var trHTML = '<tr id= "' + value.id + '">' +
                  '<td class="name">' + value.name + '</td>' +
                  '<td class="price">' + value.price + '</td>' +
                  '<td class="category">' + value.category + '</td>' +
                  '<td><button class="edit" onclick="editPet('+value.id + ')">Edit</button></td>' +
                  '<td><button class="btn_x" onclick="deletePet(' + value.id + ')">Delete</button></td>' +
                  '</tr>';
          $('#pets_table').append(trHTML);
        }
      });
    });
    $("#btn_update").click(function () {
      var name = $('input[name="name"]').val();
      var price = $('input[name="price"]').val();
      var category = $('input[name="category"]').val();
      var pet = {id : update_id, name : name, price : price, category : category};
      var data = JSON.stringify(pet);
      console.log("update - " + data);
      $.ajax({
        type: "PUT",
        url: "api/pets",
        data: data,
        contentType: "application/json; charset=utf-8",
        dataType: "json",
        success: function(value){
          var trHTML = '<tr id= "' + value.id + '">' +
                  '<td class="name">' + value.name + '</td>' +
                  '<td class="price">' + value.price + '</td>' +
                  '<td class="category">' + value.category + '</td>' +
                  '<td><button class="btn_edit" onclick="editPet('+value.id + ')">Edit</button></td>' +
                  '<td><button class="btn_delete" onclick="deletePet(' + value.id + ')">Delete</button></td>' +
                  '</tr>';
          console.log('Pet ' + value.id + ' updated.');
          $('#' + update_id).html(trHTML);
          $("#btn_create").show();
          $("#btn_update").hide();
          $('#input_name').val('');
          $('#input_price').val('');
          $('#input_category').val('');
          update_id = 0;
        }
      });
    });
  });
</script>
<table id="pets_table" border='1'>
  <tr>
    <th>Name</th>
    <th>Price</th>
    <th>Category</th>
    <th>Edit</th>
    <th>Delete</th>
  </tr>
</table>

<form id="create_form">
  <p>Name of pet : </p>
  <input id="input_name" type="text" name="name"/>
  <p>Price : </p>
  <input id="input_price" type="text" name="price"/>
  <p>Category : </p>
  <input id="input_category" type="text" name="category"/>
</form>
<br/>
<button id="btn_create">Create</button>
<button id="btn_update" hidden="hidden">Update</button>
</body>
</html>